/**
 * @file Overview
 * This ruleset is designed for an initial prototyping phase of a material order management application.
 * It prioritizes ease of development and iteration speed over fine-grained access control.
 *
 * Core Philosophy:
 * The ruleset currently operates in a "sandbox" mode with minimal restrictions, but is structured
 * to easily accommodate the introduction of user-based authentication and authorization in the future.
 *
 * Data Structure:
 * All order data is stored in a single, top-level `/pedidos` collection.
 *
 * Key Security Decisions:
 * - Currently, read access is open to all users (signed-in or anonymous).
 * - Write access is currently open but this will change after authentication is added.
 * - No user listing is allowed.
 *
 * Denormalization for Authorization:
 * Future versions will require denormalizing user IDs onto the `Order` documents to enable
 * owner-based access control. An `ownerId` field will be required for write operations.
 *
 * Structural Segregation:
 * There is no structural segregation implemented initially. All orders are stored in a single collection.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    /**
     * @description Allows read and write access to all documents in the `/pedidos` collection.
     * @path /pedidos/{pedidoId}
     * @allow (get, list) Any user can read any order.
     * @allow (create, update, delete) Any user can create, update, or delete any order.
     * @deny none
     * @principle In the current phase, allows open access for prototyping
     *
     * Future: After adding authentication, writes will be restricted to owners only.
     */
    match /pedidos/{pedidoId} {
      allow get: if true;
      allow list: if true;
      allow create: if true; // CRITICAL:  Update this rule after auth is added
      allow update: if true; // CRITICAL:  Update this rule after auth is added
      allow delete: if true; // CRITICAL:  Update this rule after auth is added
    }
  }
}